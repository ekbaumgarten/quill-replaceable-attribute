!function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=2)}([function(t,e){t.exports=Quill},function(t,e,n){},function(t,e,n){"use strict";n.r(e);var i=n(0),r=n.n(i);function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function u(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function a(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function l(t,e,n){return(l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=s(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var p=function(t){function e(t,n){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),a(this,s(e).call(this,t,n))}var n,i,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(e,t),n=e,r=[{key:"create",value:function(t){var n=l(s(e),"create",this).call(this),i=document.createElement("span"),r=document.createElement("span");return void 0===t.label&&(t.label=t.title),i.innerHTML=t.label,i.setAttribute("contentEditable",!0),i.className=n.className+"-label",i.addEventListener("keyup",(function(t){var e=t.target,r=e.innerText;n.dataset.label=r,r?e.classList.remove(i.className+"-empty"):e.classList.add(i.className+"-empty")})),n.appendChild(i),r.innerHTML=t.title,r.setAttribute("contentEditable",!1),r.className=n.className+"-value",n.appendChild(r),this.setDataValues(n,t)}},{key:"setDataValues",value:function(t,e){var n=t;return Object.keys(e).forEach((function(t){n.dataset[t]=e[t]})),n}},{key:"value",value:function(t){return t.dataset}}],(i=null)&&u(n.prototype,i),r&&u(n,r),e}(r.a.import("blots/embed"));p.blotName="replaceableAttribute",p.tagName="span",p.className="replaceable-attribute",r.a.register(p);n(1);function b(t){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function f(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function d(t){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function m(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function y(t,e){return(y=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var h=Quill.import("core/module"),v=Quill.import("formats/replaceableAttribute"),C=function(t){function e(t,n){var i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r,o,u={attributesMenuClass:"ql-replaceable-attributes-menu",attributesMenuListClass:"ql-replaceable-attributes-menu-list",attributesMenuListContainerClass:"ql-replaceable-attributes-menu-list-container",attributesListContainerClass:"ql-replaceable-attributes-menu-container",toggleButtonClass:"ql-replaceable-attributes-menu-toggle-button",menus:null};return Object.assign(u,n),r=this,(i=!(o=d(e).call(this,t,u))||"object"!==b(o)&&"function"!=typeof o?m(r):o).menu=null,i.menuOpened=!1,i.menuDirection="below",i.attributesMenuContainer=document.createElement("div"),i.attributesMenuContainer.className=i.options.attributesListContainerClass,i.attributesMenuContainer.style.display="none",i.listToggleBtn=document.createElement("button"),i.listToggleBtn.className=i.options.toggleButtonClass,i.listToggleBtn.appendChild(document.createElement("i")),i.listToggleBtn.onclick=i.listToggleButtonClick.bind(m(i)),i.attributesMenuContainer.appendChild(i.listToggleBtn),i.attributesMenu=document.createElement("div"),i.attributesMenu.className=i.options.attributesMenuClass,i.attributesMenuContainer.appendChild(i.attributesMenu),i.quill.container.appendChild(i.attributesMenuContainer),i.quill.on(Quill.events.EDITOR_CHANGE,i.onEditorChange.bind(m(i))),i.closeMenuOnDocumentClick=i.closeMenuOnDocumentClick.bind(m(i)),i.renderMenu(i.options.menus),i}var n,i,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&y(t,e)}(e,t),n=e,(i=[{key:"handleAttributeClick",value:function(t,e){v.replace(t,{title:"Attr replace",identifier:"replace.identifier",type:"attribute"})}},{key:"setAttributesMenuContainerPosition",value:function(t){var e=this.quill.getBounds(t);this.attributesMenuContainer.style.display="block",this.attributesMenuContainer.style.position="absolute",this.attributesMenuContainer.style.top=e.top+"px"}},{key:"onEditorChange",value:function(t,e){null===e&&(this.attributesMenuContainer.style.display="none"),null!==e&&t===Quill.events.SELECTION_CHANGE&&this.setAttributesMenuContainerPosition(e)}},{key:"listToggleButtonClick",value:function(t){this.quill.focus(),this.openMenu()}},{key:"closeMenuOnDocumentClick",value:function(t){this.attributesMenu.contains(t.target)||this.closeMenu()}},{key:"openMenu",value:function(){this.menuOpened=!0,this.attributesMenu.classList.add(this.options.attributesMenuClass+"--opened"),this.setMenuPosition(),this.quill.container.classList.add(this.options.attributesMenuClass+"-opened"),document.addEventListener("click",this.closeMenuOnDocumentClick,!0)}},{key:"setMenuPosition",value:function(){if(this.menuOpened){var t=this.attributesMenu.getBoundingClientRect(),e=this.listToggleBtn.getBoundingClientRect().top,n=window.innerHeight-t.bottom;this.attributesMenu.classList.remove(this.options.attributesMenuClass+"--opened--"+this.menuDirection),this.menuDirection=n<0&&e>t.height?"above":"below",this.attributesMenu.classList.add(this.options.attributesMenuClass+"--opened--"+this.menuDirection)}}},{key:"closeMenu",value:function(){this.menuOpened=!1,this.attributesMenu.classList.remove(this.options.attributesMenuClass+"--opened"),this.quill.container.classList.remove(this.options.attributesMenuClass+"-opened"),document.removeEventListener("click",this.closeMenuOnDocumentClick,!0)}},{key:"onMenuItemClick",value:function(t){t.stopImmediatePropagation(),t.preventDefault();var e=this.quill.getSelection(!0),n=t.currentTarget,i={};Object.assign(i,n.dataset),this.quill.deleteText(e.index,e.length),this.quill.insertEmbed(e.index,"replaceableAttribute",i,Quill.sources.USER),this.quill.setSelection(e.index+1,Quill.sources.USER),this.closeMenu()}},{key:"renderMenuItem",value:function(t){var e=document.createElement("li");return e.innerText=t.title,e.setAttribute("data-identifier",t.identifier),e.setAttribute("data-title",t.title),e.setAttribute("data-type",t.type||"attribute"),e.onclick=this.onMenuItemClick.bind(this),e}},{key:"renderMenuGroup",value:function(t){var e=document.createElement("div");e.className=this.options.attributesMenuListContainerClass;var n=document.createElement("span");n.className=this.options.attributesMenuListClass+"-title",n.innerText=t.title;var i=document.createElement("ul");i.className=this.options.attributesMenuListClass;var r=!0,o=!1,u=void 0;try{for(var a,l=t.attributes[Symbol.iterator]();!(r=(a=l.next()).done);r=!0){var s=a.value;i.appendChild(this.renderMenuItem(s))}}catch(t){o=!0,u=t}finally{try{r||null==l.return||l.return()}finally{if(o)throw u}}return e.appendChild(n),e.appendChild(i),e}},{key:"renderMenu",value:function(t){for(;this.attributesMenu.lastElementChild;)this.attributesMenu.removeChild(this.attributesMenu.lastElementChild);var e=!0,n=!1,i=void 0;try{for(var r,o=t[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var u=r.value;this.attributesMenu.appendChild(this.renderMenuGroup(u))}}catch(t){n=!0,i=t}finally{try{e||null==o.return||o.return()}finally{if(n)throw i}}}}])&&f(n.prototype,i),r&&f(n,r),e}(h);Quill.register("modules/replaceable-attribute",C);e.default=C}]);